/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/*
 * Copyright 2018-present Open Networking Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Injectable } from '@angular/core';
import { GlyphService } from './glyph.service';
import { LogService } from '../log.service';
import { SvgUtilService } from './svgutil.service';
import * as d3 from 'd3';
import * as i0 from "@angular/core";
import * as i1 from "./glyph.service";
import * as i2 from "../log.service";
import * as i3 from "./svgutil.service";
/** @type {?} */
var vboxSize = 50;
/** @type {?} */
var cornerSize = vboxSize / 10;
/** @type {?} */
var viewBox = '0 0 ' + vboxSize + ' ' + vboxSize;
/** @type {?} */
export var glyphMapping = new Map([
    // Maps icon ID to the glyph ID it uses.
    // NOTE: icon ID maps to a CSS class for styling that icon
    ['active', 'checkMark'],
    ['inactive', 'xMark'],
    ['plus', 'plus'],
    ['minus', 'minus'],
    ['play', 'play'],
    ['stop', 'stop'],
    ['upload', 'upload'],
    ['download', 'download'],
    ['delta', 'delta'],
    ['nonzero', 'nonzero'],
    ['close', 'xClose'],
    ['m_cloud', 'm_cloud'],
    ['m_map', 'm_map'],
    ['m_selectMap', 'm_selectMap'],
    ['thatsNoMoon', 'thatsNoMoon'],
    ['m_ports', 'm_ports'],
    ['m_switch', 'm_switch'],
    ['m_roadm', 'm_roadm'],
    ['m_router', 'm_router'],
    ['m_uiAttached', 'm_uiAttached'],
    ['m_endstation', 'm_endstation'],
    ['m_summary', 'm_summary'],
    ['m_details', 'm_details'],
    ['m_oblique', 'm_oblique'],
    ['m_filters', 'm_filters'],
    ['m_cycleLabels', 'm_cycleLabels'],
    ['m_cycleGridDisplay', 'm_cycleGridDisplay'],
    ['m_prev', 'm_prev'],
    ['m_next', 'm_next'],
    ['m_flows', 'm_flows'],
    ['m_allTraffic', 'm_allTraffic'],
    ['m_xMark', 'm_xMark'],
    ['m_resetZoom', 'm_resetZoom'],
    ['m_eqMaster', 'm_eqMaster'],
    ['m_unknown', 'm_unknown'],
    ['m_controller', 'm_controller'],
    ['m_eqMaster', 'm_eqMaster'],
    ['m_virtual', 'm_virtual'],
    ['m_other', 'm_other'],
    ['m_bgpSpeaker', 'm_bgpSpeaker'],
    ['m_otn', 'm_otn'],
    ['m_roadm_otn', 'm_roadm_otn'],
    ['m_fiberSwitch', 'm_fiberSwitch'],
    ['m_microwave', 'm_microwave'],
    ['m_relatedIntents', 'm_relatedIntents'],
    ['m_intentTraffic', 'm_intentTraffic'],
    ['m_firewall', 'm_firewall'],
    ['m_balancer', 'm_balancer'],
    ['m_ips', 'm_ips'],
    ['m_ids', 'm_ids'],
    ['m_olt', 'm_olt'],
    ['m_onu', 'm_onu'],
    ['m_swap', 'm_swap'],
    ['m_shortestGeoPath', 'm_shortestGeoPath'],
    ['m_source', 'm_source'],
    ['m_destination', 'm_destination'],
    ['m_topo', 'm_topo'],
    ['m_shortestPath', 'm_shortestPath'],
    ['m_disjointPaths', 'm_disjointPaths'],
    ['m_region', 'm_region'],
    ['topo', 'topo'],
    ['bird', 'bird'],
    ['refresh', 'refresh'],
    ['query', 'query'],
    ['garbage', 'garbage'],
    ['upArrow', 'triangleUp'],
    ['downArrow', 'triangleDown'],
    ['triangleLeft', 'triangleLeft'],
    ['triangleRight', 'triangleRight'],
    ['appInactive', 'unknown'],
    ['uiAttached', 'uiAttached'],
    ['node', 'node'],
    ['devIcon_SWITCH', 'switch'],
    ['devIcon_ROADM', 'roadm'],
    ['devIcon_OTN', 'otn'],
    ['portIcon_DEFAULT', 'm_ports'],
    ['meter', 'meterTable'],
    ['deviceTable', 'switch'],
    ['flowTable', 'flowTable'],
    ['portTable', 'portTable'],
    ['groupTable', 'groupTable'],
    ['meterTable', 'meterTable'],
    ['pipeconfTable', 'pipeconfTable'],
    ['hostIcon_endstation', 'endstation'],
    ['hostIcon_router', 'router'],
    ['hostIcon_bgpSpeaker', 'bgpSpeaker'],
    // navigation menu icons...
    ['nav_apps', 'bird'],
    ['nav_settings', 'cog'],
    ['nav_cluster', 'node'],
    ['nav_processors', 'allTraffic'],
    ['nav_partitions', 'unknown'],
    ['nav_topo', 'topo'],
    ['nav_topo2', 'm_cloud'],
    ['nav_devs', 'switch'],
    ['nav_links', 'ports'],
    ['nav_hosts', 'endstation'],
    ['nav_intents', 'relatedIntents'],
    ['nav_tunnels', 'ports'],
    ['nav_yang', 'yang'],
]);
/**
 * ONOS GUI -- SVG -- Icon Service
 */
var IconService = /** @class */ (function () {
    function IconService(gs, log, sus) {
        this.gs = gs;
        this.log = log;
        this.sus = sus;
        this.log.debug('IconService constructed');
    }
    /**
     * @return {?}
     */
    IconService.prototype.ensureIconLibDefs = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var body = d3.select('body');
        /** @type {?} */
        var svg = body.select('svg#IconLibDefs');
        if (svg.empty()) {
            svg = body.append('svg').attr('id', 'IconLibDefs');
            svg.append('defs');
        }
        return svg.select('defs');
    };
    /**
     * Load an icon
     *
     * @param div A D3 selection of the '&lt;div&gt;' element into which icon should load
     * @param glyphId Identifies the glyph to use
     * @param size The dimension of icon in pixels. Defaults to 20.
     * @param installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     */
    /**
     * Load an icon
     *
     * @param {?} div A D3 selection of the '&lt;div&gt;' element into which icon should load
     * @param {?=} glyphId Identifies the glyph to use
     * @param {?=} size The dimension of icon in pixels. Defaults to 20.
     * @param {?=} installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param {?=} svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     * @return {?}
     */
    IconService.prototype.loadIcon = /**
     * Load an icon
     *
     * @param {?} div A D3 selection of the '&lt;div&gt;' element into which icon should load
     * @param {?=} glyphId Identifies the glyph to use
     * @param {?=} size The dimension of icon in pixels. Defaults to 20.
     * @param {?=} installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param {?=} svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     * @return {?}
     */
    function (div, glyphId, size, installGlyph, svgClass) {
        if (glyphId === void 0) { glyphId = 'unknown'; }
        if (size === void 0) { size = 20; }
        if (installGlyph === void 0) { installGlyph = true; }
        if (svgClass === void 0) { svgClass = 'embeddedIcon'; }
        /** @type {?} */
        var dim = size || 20;
        /** @type {?} */
        var svgCls = svgClass || 'embeddedIcon';
        /** @type {?} */
        var gid = glyphId || 'unknown';
        /** @type {?} */
        var g;
        /** @type {?} */
        var svgIcon;
        if (installGlyph) {
            this.gs.loadDefs(this.ensureIconLibDefs(), [gid], true);
        }
        this.log.warn('loadEmbeddedIcon. install done');
        svgIcon = div
            .append('svg')
            .attr('class', svgCls)
            .attr('width', dim)
            .attr('height', dim)
            .attr('viewBox', viewBox);
        g = svgIcon.append('g')
            .attr('class', 'icon');
        g.append('rect')
            .attr('width', vboxSize)
            .attr('height', vboxSize)
            .attr('rx', cornerSize);
        g.append('use')
            .attr('width', vboxSize)
            .attr('height', vboxSize)
            .attr('class', 'glyph')
            .attr('xlink:href', '#' + gid);
    };
    /**
     * Load an icon by class.
     * @param div A D3 selection of the <DIV> element into which icon should load
     * @param iconCls The CSS class used to identify the icon
     * @param size The dimension of icon in pixels. Defaults to 20.
     * @param installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     */
    /**
     * Load an icon by class.
     * @param {?} div A D3 selection of the <DIV> element into which icon should load
     * @param {?} iconCls The CSS class used to identify the icon
     * @param {?} size The dimension of icon in pixels. Defaults to 20.
     * @param {?} installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param {?=} svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     * @return {?}
     */
    IconService.prototype.loadIconByClass = /**
     * Load an icon by class.
     * @param {?} div A D3 selection of the <DIV> element into which icon should load
     * @param {?} iconCls The CSS class used to identify the icon
     * @param {?} size The dimension of icon in pixels. Defaults to 20.
     * @param {?} installGlyph If truthy, will cause the glyph to be added to
     *      well-known defs element. Defaults to false.
     * @param {?=} svgClass The CSS class used to identify the SVG layer.
     *      Defaults to 'embeddedIcon'.
     * @return {?}
     */
    function (div, iconCls, size, installGlyph, svgClass) {
        if (svgClass === void 0) { svgClass = 'embeddedIcon'; }
        this.loadIcon(div, glyphMapping.get(iconCls), size, installGlyph, svgClass);
        div.select('svg g').classed(iconCls, true);
    };
    /**
     * Load an embedded icon.
     */
    /**
     * Load an embedded icon.
     * @param {?} div
     * @param {?} iconCls
     * @param {?} size
     * @return {?}
     */
    IconService.prototype.loadEmbeddedIcon = /**
     * Load an embedded icon.
     * @param {?} div
     * @param {?} iconCls
     * @param {?} size
     * @return {?}
     */
    function (div, iconCls, size) {
        this.loadIconByClass(div, iconCls, size, true);
    };
    /**
     * Load an icon only to the svg defs collection
     *
     * Note: This is added for use with IconComponent, where the icon's
     * svg element is defined in the component template (and not built
     * inline using d3 manipulation
     *
     * @param iconCls The icon class as a string
     */
    /**
     * Load an icon only to the svg defs collection
     *
     * Note: This is added for use with IconComponent, where the icon's
     * svg element is defined in the component template (and not built
     * inline using d3 manipulation
     *
     * @param {?} iconCls The icon class as a string
     * @return {?}
     */
    IconService.prototype.loadIconDef = /**
     * Load an icon only to the svg defs collection
     *
     * Note: This is added for use with IconComponent, where the icon's
     * svg element is defined in the component template (and not built
     * inline using d3 manipulation
     *
     * @param {?} iconCls The icon class as a string
     * @return {?}
     */
    function (iconCls) {
        /** @type {?} */
        var glyphName = glyphMapping.get(iconCls);
        if (!glyphName) {
            glyphName = iconCls;
        }
        this.gs.loadDefs(this.ensureIconLibDefs(), [glyphName], true);
        this.log.debug('icon definition', iconCls, 'added to defs');
    };
    /**
     * Add a device icon
     *
     * Adds a device glyph to the specified element.
     * Returns the D3 selection of the glyph (use) element.
     */
    /**
     * Add a device icon
     *
     * Adds a device glyph to the specified element.
     * Returns the D3 selection of the glyph (use) element.
     * @param {?} elem
     * @param {?} glyphId
     * @param {?} iconDim
     * @return {?}
     */
    IconService.prototype.addDeviceIcon = /**
     * Add a device icon
     *
     * Adds a device glyph to the specified element.
     * Returns the D3 selection of the glyph (use) element.
     * @param {?} elem
     * @param {?} glyphId
     * @param {?} iconDim
     * @return {?}
     */
    function (elem, glyphId, iconDim) {
        /** @type {?} */
        var gid = this.gs.glyphDefined(glyphId) ? glyphId : 'query';
        return elem.append('use').attr({
            'xlink:href': '#' + gid,
            width: iconDim,
            height: iconDim,
        });
    };
    /**
     * @param {?} elem
     * @param {?} radius
     * @param {?} glyphId
     * @return {?}
     */
    IconService.prototype.addHostIcon = /**
     * @param {?} elem
     * @param {?} radius
     * @param {?} glyphId
     * @return {?}
     */
    function (elem, radius, glyphId) {
        /** @type {?} */
        var dim = radius * 1.5;
        /** @type {?} */
        var xlate = -dim / 2;
        /** @type {?} */
        var g = elem.append('g')
            .attr('class', 'svgIcon hostIcon');
        g.append('circle').attr('r', radius);
        g.append('use').attr({
            'xlink:href': '#' + glyphId,
            width: dim,
            height: dim,
            transform: this.sus.translate([xlate], xlate),
        });
        return g;
    };
    /**
     * @param {?} iconId
     * @param {?} glyphId
     * @return {?}
     */
    IconService.prototype.registerIconMapping = /**
     * @param {?} iconId
     * @param {?} glyphId
     * @return {?}
     */
    function (iconId, glyphId) {
        if (glyphMapping[iconId]) {
            this.log.warn('Icon with id', iconId, 'already mapped. Ignoring.');
        }
        else {
            // map icon-->glyph
            glyphMapping[iconId] = glyphId;
            // make sure definition is installed
            this.gs.loadDefs(this.ensureIconLibDefs(), [glyphId], true);
        }
    };
    IconService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root',
                },] },
    ];
    /** @nocollapse */
    IconService.ctorParameters = function () { return [
        { type: GlyphService },
        { type: LogService },
        { type: SvgUtilService }
    ]; };
    /** @nocollapse */ IconService.ngInjectableDef = i0.defineInjectable({ factory: function IconService_Factory() { return new IconService(i0.inject(i1.GlyphService), i0.inject(i2.LogService), i0.inject(i3.SvgUtilService)); }, token: IconService, providedIn: "root" });
    return IconService;
}());
export { IconService };
if (false) {
    /** @type {?} */
    IconService.prototype.gs;
    /** @type {?} */
    IconService.prototype.log;
    /** @type {?} */
    IconService.prototype.sus;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWNvbi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vZ3VpMi1mdy1saWIvIiwic291cmNlcyI6WyJsaWIvc3ZnL2ljb24uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzVDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEtBQUssRUFBRSxNQUFNLElBQUksQ0FBQzs7Ozs7O0lBRW5CLFFBQVEsR0FBRyxFQUFFOztJQUNiLFVBQVUsR0FBRyxRQUFRLEdBQUcsRUFBRTs7SUFDMUIsT0FBTyxHQUFHLE1BQU0sR0FBRyxRQUFRLEdBQUcsR0FBRyxHQUFHLFFBQVE7O0FBRWxELE1BQU0sS0FBTyxZQUFZLEdBQUcsSUFBSSxHQUFHLENBQWlCO0lBQ2hELHdDQUF3QztJQUN4QywwREFBMEQ7SUFDMUQsQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDO0lBQ3ZCLENBQUMsVUFBVSxFQUFFLE9BQU8sQ0FBQztJQUVyQixDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUM7SUFDaEIsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDO0lBQ2xCLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQztJQUNoQixDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUM7SUFFaEIsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDO0lBQ3BCLENBQUMsVUFBVSxFQUFFLFVBQVUsQ0FBQztJQUN4QixDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUM7SUFDbEIsQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDO0lBQ3RCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQztJQUVuQixDQUFDLFNBQVMsRUFBRSxTQUFT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QUNuQixZQUFZLENBQUMsTUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDO1lBQy9CLG9DQUFvQztZQUNwQyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQy9EO0lBQ0wsQ0FBQzs7Z0JBdkpKLFVBQVUsU0FBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkI7Ozs7Z0JBdElRLFlBQVk7Z0JBQ1osVUFBVTtnQkFDVixjQUFjOzs7c0JBbEJ2QjtDQTRTQyxBQXhKRCxJQXdKQztTQXJKWSxXQUFXOzs7SUFHaEIseUJBQXdCOztJQUN4QiwwQkFBdUI7O0lBQ3ZCLDBCQUEyQiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxOC1wcmVzZW50IE9wZW4gTmV0d29ya2luZyBGb3VuZGF0aW9uXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBHbHlwaFNlcnZpY2UgfSBmcm9tICcuL2dseXBoLnNlcnZpY2UnO1xuaW1wb3J0IHsgTG9nU2VydmljZSB9IGZyb20gJy4uL2xvZy5zZXJ2aWNlJztcbmltcG9ydCB7IFN2Z1V0aWxTZXJ2aWNlIH0gZnJvbSAnLi9zdmd1dGlsLnNlcnZpY2UnO1xuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xuXG5jb25zdCB2Ym94U2l6ZSA9IDUwO1xuY29uc3QgY29ybmVyU2l6ZSA9IHZib3hTaXplIC8gMTA7XG5jb25zdCB2aWV3Qm94ID0gJzAgMCAnICsgdmJveFNpemUgKyAnICcgKyB2Ym94U2l6ZTtcblxuZXhwb3J0IGNvbnN0IGdseXBoTWFwcGluZyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KFtcbiAgICAvLyBNYXBzIGljb24gSUQgdG8gdGhlIGdseXBoIElEIGl0IHVzZXMuXG4gICAgLy8gTk9URTogaWNvbiBJRCBtYXBzIHRvIGEgQ1NTIGNsYXNzIGZvciBzdHlsaW5nIHRoYXQgaWNvblxuICAgIFsnYWN0aXZlJywgJ2NoZWNrTWFyayddLFxuICAgIFsnaW5hY3RpdmUnLCAneE1hcmsnXSxcblxuICAgIFsncGx1cycsICdwbHVzJ10sXG4gICAgWydtaW51cycsICdtaW51cyddLFxuICAgIFsncGxheScsICdwbGF5J10sXG4gICAgWydzdG9wJywgJ3N0b3AnXSxcblxuICAgIFsndXBsb2FkJywgJ3VwbG9hZCddLFxuICAgIFsnZG93bmxvYWQnLCAnZG93bmxvYWQnXSxcbiAgICBbJ2RlbHRhJywgJ2RlbHRhJ10sXG4gICAgWydub256ZXJvJywgJ25vbnplcm8nXSxcbiAgICBbJ2Nsb3NlJywgJ3hDbG9zZSddLFxuXG4gICAgWydtX2Nsb3VkJywgJ21fY2xvdWQnXSxcbiAgICBbJ21fbWFwJywgJ21fbWFwJ10sXG4gICAgWydtX3NlbGVjdE1hcCcsICdtX3NlbGVjdE1hcCddLFxuICAgIFsndGhhdHNOb01vb24nLCAndGhhdHNOb01vb24nXSxcbiAgICBbJ21fcG9ydHMnLCAnbV9wb3J0cyddLFxuICAgIFsnbV9zd2l0Y2gnLCAnbV9zd2l0Y2gnXSxcbiAgICBbJ21fcm9hZG0nLCAnbV9yb2FkbSddLFxuICAgIFsnbV9yb3V0ZXInLCAnbV9yb3V0ZXInXSxcbiAgICBbJ21fdWlBdHRhY2hlZCcsICdtX3VpQXR0YWNoZWQnXSxcbiAgICBbJ21fZW5kc3RhdGlvbicsICdtX2VuZHN0YXRpb24nXSxcbiAgICBbJ21fc3VtbWFyeScsICdtX3N1bW1hcnknXSxcbiAgICBbJ21fZGV0YWlscycsICdtX2RldGFpbHMnXSxcbiAgICBbJ21fb2JsaXF1ZScsICdtX29ibGlxdWUnXSxcbiAgICBbJ21fZmlsdGVycycsICdtX2ZpbHRlcnMnXSxcbiAgICBbJ21fY3ljbGVMYWJlbHMnLCAnbV9jeWNsZUxhYmVscyddLFxuICAgIFsnbV9jeWNsZUdyaWREaXNwbGF5JywgJ21fY3ljbGVHcmlkRGlzcGxheSddLFxuICAgIFsnbV9wcmV2JywgJ21fcHJldiddLFxuICAgIFsnbV9uZXh0JywgJ21fbmV4dCddLFxuICAgIFsnbV9mbG93cycsICdtX2Zsb3dzJ10sXG4gICAgWydtX2FsbFRyYWZmaWMnLCAnbV9hbGxUcmFmZmljJ10sXG4gICAgWydtX3hNYXJrJywgJ21feE1hcmsnXSxcbiAgICBbJ21fcmVzZXRab29tJywgJ21fcmVzZXRab29tJ10sXG4gICAgWydtX2VxTWFzdGVyJywgJ21fZXFNYXN0ZXInXSxcbiAgICBbJ21fdW5rbm93bicsICdtX3Vua25vd24nXSxcbiAgICBbJ21fY29udHJvbGxlcicsICdtX2NvbnRyb2xsZXInXSxcbiAgICBbJ21fZXFNYXN0ZXInLCAnbV9lcU1hc3RlciddLFxuICAgIFsnbV92aXJ0dWFsJywgJ21fdmlydHVhbCddLFxuICAgIFsnbV9vdGhlcicsICdtX290aGVyJ10sXG4gICAgWydtX2JncFNwZWFrZXInLCAnbV9iZ3BTcGVha2VyJ10sXG4gICAgWydtX290bicsICdtX290biddLFxuICAgIFsnbV9yb2FkbV9vdG4nLCAnbV9yb2FkbV9vdG4nXSxcbiAgICBbJ21fZmliZXJTd2l0Y2gnLCAnbV9maWJlclN3aXRjaCddLFxuICAgIFsnbV9taWNyb3dhdmUnLCAnbV9taWNyb3dhdmUnXSxcbiAgICBbJ21fcmVsYXRlZEludGVudHMnLCAnbV9yZWxhdGVkSW50ZW50cyddLFxuICAgIFsnbV9pbnRlbnRUcmFmZmljJywgJ21faW50ZW50VHJhZmZpYyddLFxuICAgIFsnbV9maXJld2FsbCcsICdtX2ZpcmV3YWxsJ10sXG4gICAgWydtX2JhbGFuY2VyJywgJ21fYmFsYW5jZXInXSxcbiAgICBbJ21faXBzJywgJ21faXBzJ10sXG4gICAgWydtX2lkcycsICdtX2lkcyddLFxuICAgIFsnbV9vbHQnLCAnbV9vbHQnXSxcbiAgICBbJ21fb251JywgJ21fb251J10sXG4gICAgWydtX3N3YXAnLCAnbV9zd2FwJ10sXG4gICAgWydtX3Nob3J0ZXN0R2VvUGF0aCcsICdtX3Nob3J0ZXN0R2VvUGF0aCddLFxuICAgIFsnbV9zb3VyY2UnLCAnbV9zb3VyY2UnXSxcbiAgICBbJ21fZGVzdGluYXRpb24nLCAnbV9kZXN0aW5hdGlvbiddLFxuICAgIFsnbV90b3BvJywgJ21fdG9wbyddLFxuICAgIFsnbV9zaG9ydGVzdFBhdGgnLCAnbV9zaG9ydGVzdFBhdGgnXSxcbiAgICBbJ21fZGlzam9pbnRQYXRocycsICdtX2Rpc2pvaW50UGF0aHMnXSxcbiAgICBbJ21fcmVnaW9uJywgJ21fcmVnaW9uJ10sXG5cbiAgICBbJ3RvcG8nLCAndG9wbyddLFxuICAgIFsnYmlyZCcsICdiaXJkJ10sXG5cbiAgICBbJ3JlZnJlc2gnLCAncmVmcmVzaCddLFxuICAgIFsncXVlcnknLCAncXVlcnknXSxcbiAgICBbJ2dhcmJhZ2UnLCAnZ2FyYmFnZSddLFxuXG5cbiAgICBbJ3VwQXJyb3cnLCAndHJpYW5nbGVVcCddLFxuICAgIFsnZG93bkFycm93JywgJ3RyaWFuZ2xlRG93biddLFxuICAgIFsndHJpYW5nbGVMZWZ0JywgJ3RyaWFuZ2xlTGVmdCddLFxuICAgIFsndHJpYW5nbGVSaWdodCcsICd0cmlhbmdsZVJpZ2h0J10sXG5cbiAgICBbJ2FwcEluYWN0aXZlJywgJ3Vua25vd24nXSxcbiAgICBbJ3VpQXR0YWNoZWQnLCAndWlBdHRhY2hlZCddLFxuXG4gICAgWydub2RlJywgJ25vZGUnXSxcbiAgICBbJ2Rldkljb25fU1dJVENIJywgJ3N3aXRjaCddLFxuICAgIFsnZGV2SWNvbl9ST0FETScsICdyb2FkbSddLFxuICAgIFsnZGV2SWNvbl9PVE4nLCAnb3RuJ10sXG5cbiAgICBbJ3BvcnRJY29uX0RFRkFVTFQnLCAnbV9wb3J0cyddLFxuXG4gICAgWydtZXRlcicsICdtZXRlclRhYmxlJ10sIC8vIFRPRE86IG1fbWV0ZXIgaWNvbj9cblxuICAgIFsnZGV2aWNlVGFibGUnLCAnc3dpdGNoJ10sXG4gICAgWydmbG93VGFibGUnLCAnZmxvd1RhYmxlJ10sXG4gICAgWydwb3J0VGFibGUnLCAncG9ydFRhYmxlJ10sXG4gICAgWydncm91cFRhYmxlJywgJ2dyb3VwVGFibGUnXSxcbiAgICBbJ21ldGVyVGFibGUnLCAnbWV0ZXJUYWJsZSddLFxuICAgIFsncGlwZWNvbmZUYWJsZScsICdwaXBlY29uZlRhYmxlJ10sXG5cbiAgICBbJ2hvc3RJY29uX2VuZHN0YXRpb24nLCAnZW5kc3RhdGlvbiddLFxuICAgIFsnaG9zdEljb25fcm91dGVyJywgJ3JvdXRlciddLFxuICAgIFsnaG9zdEljb25fYmdwU3BlYWtlcicsICdiZ3BTcGVha2VyJ10sXG5cbiAgICAvLyBuYXZpZ2F0aW9uIG1lbnUgaWNvbnMuLi5cbiAgICBbJ25hdl9hcHBzJywgJ2JpcmQnXSxcbiAgICBbJ25hdl9zZXR0aW5ncycsICdjb2cnXSxcbiAgICBbJ25hdl9jbHVzdGVyJywgJ25vZGUnXSxcbiAgICBbJ25hdl9wcm9jZXNzb3JzJywgJ2FsbFRyYWZmaWMnXSxcbiAgICBbJ25hdl9wYXJ0aXRpb25zJywgJ3Vua25vd24nXSxcblxuICAgIFsnbmF2X3RvcG8nLCAndG9wbyddLFxuICAgIFsnbmF2X3RvcG8yJywgJ21fY2xvdWQnXSxcbiAgICBbJ25hdl9kZXZzJywgJ3N3aXRjaCddLFxuICAgIFsnbmF2X2xpbmtzJywgJ3BvcnRzJ10sXG4gICAgWyduYXZfaG9zdHMnLCAnZW5kc3RhdGlvbiddLFxuICAgIFsnbmF2X2ludGVudHMnLCAncmVsYXRlZEludGVudHMnXSxcbiAgICBbJ25hdl90dW5uZWxzJywgJ3BvcnRzJ10sIC8vIFRPRE86IHVzZSB0dW5uZWwgZ2x5cGgsIHdoZW4gYXZhaWxhYmxlXG4gICAgWyduYXZfeWFuZycsICd5YW5nJ10sXG5dKTtcblxuLyoqXG4gKiBPTk9TIEdVSSAtLSBTVkcgLS0gSWNvbiBTZXJ2aWNlXG4gKi9cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBJY29uU2VydmljZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBnczogR2x5cGhTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIGxvZzogTG9nU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBzdXM6IFN2Z1V0aWxTZXJ2aWNlXG4gICAgKSB7XG5cbiAgICAgICAgdGhpcy5sb2cuZGVidWcoJ0ljb25TZXJ2aWNlIGNvbnN0cnVjdGVkJyk7XG4gICAgfVxuXG4gICAgZW5zdXJlSWNvbkxpYkRlZnMoKSB7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBkMy5zZWxlY3QoJ2JvZHknKTtcbiAgICAgICAgbGV0IHN2ZyA9IGJvZHkuc2VsZWN0KCdzdmcjSWNvbkxpYkRlZnMnKTtcbiAgICAgICAgaWYgKHN2Zy5lbXB0eSgpKSB7XG4gICAgICAgICAgICBzdmcgPSBib2R5LmFwcGVuZCgnc3ZnJykuYXR0cignaWQnLCAnSWNvbkxpYkRlZnMnKTtcbiAgICAgICAgICAgIHN2Zy5hcHBlbmQoJ2RlZnMnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3ZnLnNlbGVjdCgnZGVmcycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgYW4gaWNvblxuICAgICAqXG4gICAgICogQHBhcmFtIGRpdiBBIEQzIHNlbGVjdGlvbiBvZiB0aGUgJyZsdDtkaXYmZ3Q7JyBlbGVtZW50IGludG8gd2hpY2ggaWNvbiBzaG91bGQgbG9hZFxuICAgICAqIEBwYXJhbSBnbHlwaElkIElkZW50aWZpZXMgdGhlIGdseXBoIHRvIHVzZVxuICAgICAqIEBwYXJhbSBzaXplIFRoZSBkaW1lbnNpb24gb2YgaWNvbiBpbiBwaXhlbHMuIERlZmF1bHRzIHRvIDIwLlxuICAgICAqIEBwYXJhbSBpbnN0YWxsR2x5cGggSWYgdHJ1dGh5LCB3aWxsIGNhdXNlIHRoZSBnbHlwaCB0byBiZSBhZGRlZCB0b1xuICAgICAqICAgICAgd2VsbC1rbm93biBkZWZzIGVsZW1lbnQuIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgICAqIEBwYXJhbSBzdmdDbGFzcyBUaGUgQ1NTIGNsYXNzIHVzZWQgdG8gaWRlbnRpZnkgdGhlIFNWRyBsYXllci5cbiAgICAgKiAgICAgIERlZmF1bHRzIHRvICdlbWJlZGRlZEljb24nLlxuICAgICAqL1xuICAgIGxvYWRJY29uKGRpdiwgZ2x5cGhJZDogc3RyaW5nID0gJ3Vua25vd24nLCBzaXplOiBudW1iZXIgPSAyMCwgaW5zdGFsbEdseXBoOiBib29sZWFuID0gdHJ1ZSwgc3ZnQ2xhc3M6IHN0cmluZyA9ICdlbWJlZGRlZEljb24nKSB7XG4gICAgICAgIGNvbnN0IGRpbSA9IHNpemUgfHwgMjA7XG4gICAgICAgIGNvbnN0IHN2Z0NscyA9IHN2Z0NsYXNzIHx8ICdlbWJlZGRlZEljb24nO1xuICAgICAgICBjb25zdCBnaWQgPSBnbHlwaElkIHx8ICd1bmtub3duJztcbiAgICAgICAgbGV0IGc7XG4gICAgICAgIGxldCBzdmdJY29uOiBhbnk7XG5cbiAgICAgICAgaWYgKGluc3RhbGxHbHlwaCkge1xuICAgICAgICAgICAgdGhpcy5ncy5sb2FkRGVmcyh0aGlzLmVuc3VyZUljb25MaWJEZWZzKCksIFtnaWRdLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvZy53YXJuKCdsb2FkRW1iZWRkZWRJY29uLiBpbnN0YWxsIGRvbmUnKTtcblxuICAgICAgICBzdmdJY29uID0gZGl2XG4gICAgICAgICAgICAuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgc3ZnQ2xzKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgZGltKVxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGRpbSlcbiAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94Jywgdmlld0JveCk7XG5cbiAgICAgICAgZyA9IHN2Z0ljb24uYXBwZW5kKCdnJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdpY29uJyk7XG5cbiAgICAgICAgZy5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgdmJveFNpemUpXG4gICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgdmJveFNpemUpXG4gICAgICAgICAgICAuYXR0cigncngnLCBjb3JuZXJTaXplKTtcblxuICAgICAgICBnLmFwcGVuZCgndXNlJylcbiAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHZib3hTaXplKVxuICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHZib3hTaXplKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2dseXBoJylcbiAgICAgICAgICAgIC5hdHRyKCd4bGluazpocmVmJywgJyMnICsgZ2lkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGFuIGljb24gYnkgY2xhc3MuXG4gICAgICogQHBhcmFtIGRpdiBBIEQzIHNlbGVjdGlvbiBvZiB0aGUgPERJVj4gZWxlbWVudCBpbnRvIHdoaWNoIGljb24gc2hvdWxkIGxvYWRcbiAgICAgKiBAcGFyYW0gaWNvbkNscyBUaGUgQ1NTIGNsYXNzIHVzZWQgdG8gaWRlbnRpZnkgdGhlIGljb25cbiAgICAgKiBAcGFyYW0gc2l6ZSBUaGUgZGltZW5zaW9uIG9mIGljb24gaW4gcGl4ZWxzLiBEZWZhdWx0cyB0byAyMC5cbiAgICAgKiBAcGFyYW0gaW5zdGFsbEdseXBoIElmIHRydXRoeSwgd2lsbCBjYXVzZSB0aGUgZ2x5cGggdG8gYmUgYWRkZWQgdG9cbiAgICAgKiAgICAgIHdlbGwta25vd24gZGVmcyBlbGVtZW50LiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICAgKiBAcGFyYW0gc3ZnQ2xhc3MgVGhlIENTUyBjbGFzcyB1c2VkIHRvIGlkZW50aWZ5IHRoZSBTVkcgbGF5ZXIuXG4gICAgICogICAgICBEZWZhdWx0cyB0byAnZW1iZWRkZWRJY29uJy5cbiAgICAgKi9cbiAgICBsb2FkSWNvbkJ5Q2xhc3MoZGl2LCBpY29uQ2xzOiBzdHJpbmcsIHNpemU6IG51bWJlciwgaW5zdGFsbEdseXBoOiBib29sZWFuLCBzdmdDbGFzcz0gJ2VtYmVkZGVkSWNvbicpIHtcbiAgICAgICAgdGhpcy5sb2FkSWNvbihkaXYsIGdseXBoTWFwcGluZy5nZXQoaWNvbkNscyksIHNpemUsIGluc3RhbGxHbHlwaCwgc3ZnQ2xhc3MpO1xuICAgICAgICBkaXYuc2VsZWN0KCdzdmcgZycpLmNsYXNzZWQoaWNvbkNscywgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBhbiBlbWJlZGRlZCBpY29uLlxuICAgICAqL1xuICAgIGxvYWRFbWJlZGRlZEljb24oZGl2LCBpY29uQ2xzOiBzdHJpbmcsIHNpemU6IG51bWJlcikge1xuICAgICAgICB0aGlzLmxvYWRJY29uQnlDbGFzcyhkaXYsIGljb25DbHMsIHNpemUsIHRydWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgYW4gaWNvbiBvbmx5IHRvIHRoZSBzdmcgZGVmcyBjb2xsZWN0aW9uXG4gICAgICpcbiAgICAgKiBOb3RlOiBUaGlzIGlzIGFkZGVkIGZvciB1c2Ugd2l0aCBJY29uQ29tcG9uZW50LCB3aGVyZSB0aGUgaWNvbidzXG4gICAgICogc3ZnIGVsZW1lbnQgaXMgZGVmaW5lZCBpbiB0aGUgY29tcG9uZW50IHRlbXBsYXRlIChhbmQgbm90IGJ1aWx0XG4gICAgICogaW5saW5lIHVzaW5nIGQzIG1hbmlwdWxhdGlvblxuICAgICAqXG4gICAgICogQHBhcmFtIGljb25DbHMgVGhlIGljb24gY2xhc3MgYXMgYSBzdHJpbmdcbiAgICAgKi9cbiAgICBsb2FkSWNvbkRlZihpY29uQ2xzOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbGV0IGdseXBoTmFtZTogc3RyaW5nID0gZ2x5cGhNYXBwaW5nLmdldChpY29uQ2xzKTtcbiAgICAgICAgaWYgKCFnbHlwaE5hbWUpIHtcbiAgICAgICAgICAgIGdseXBoTmFtZSA9IGljb25DbHM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ncy5sb2FkRGVmcyh0aGlzLmVuc3VyZUljb25MaWJEZWZzKCksIFtnbHlwaE5hbWVdLCB0cnVlKTtcbiAgICAgICAgdGhpcy5sb2cuZGVidWcoJ2ljb24gZGVmaW5pdGlvbicsIGljb25DbHMsICdhZGRlZCB0byBkZWZzJyk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBkZXZpY2UgaWNvblxuICAgICAqXG4gICAgICogQWRkcyBhIGRldmljZSBnbHlwaCB0byB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gICAgICogUmV0dXJucyB0aGUgRDMgc2VsZWN0aW9uIG9mIHRoZSBnbHlwaCAodXNlKSBlbGVtZW50LlxuICAgICAqL1xuICAgIGFkZERldmljZUljb24oZWxlbSwgZ2x5cGhJZCwgaWNvbkRpbSkge1xuICAgICAgICBjb25zdCBnaWQgPSB0aGlzLmdzLmdseXBoRGVmaW5lZChnbHlwaElkKSA/IGdseXBoSWQgOiAncXVlcnknO1xuICAgICAgICByZXR1cm4gZWxlbS5hcHBlbmQoJ3VzZScpLmF0dHIoe1xuICAgICAgICAgICAgJ3hsaW5rOmhyZWYnOiAnIycgKyBnaWQsXG4gICAgICAgICAgICB3aWR0aDogaWNvbkRpbSxcbiAgICAgICAgICAgIGhlaWdodDogaWNvbkRpbSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkSG9zdEljb24oZWxlbSwgcmFkaXVzLCBnbHlwaElkKSB7XG4gICAgICAgIGNvbnN0IGRpbSA9IHJhZGl1cyAqIDEuNTtcbiAgICAgICAgY29uc3QgeGxhdGUgPSAtZGltIC8gMjtcbiAgICAgICAgY29uc3QgZyA9IGVsZW0uYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3ZnSWNvbiBob3N0SWNvbicpO1xuXG4gICAgICAgIGcuYXBwZW5kKCdjaXJjbGUnKS5hdHRyKCdyJywgcmFkaXVzKTtcblxuICAgICAgICBnLmFwcGVuZCgndXNlJykuYXR0cih7XG4gICAgICAgICAgICAneGxpbms6aHJlZic6ICcjJyArIGdseXBoSWQsXG4gICAgICAgICAgICB3aWR0aDogZGltLFxuICAgICAgICAgICAgaGVpZ2h0OiBkaW0sXG4gICAgICAgICAgICB0cmFuc2Zvcm06IHRoaXMuc3VzLnRyYW5zbGF0ZShbeGxhdGVdLCB4bGF0ZSksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZztcbiAgICB9XG5cbiAgICByZWdpc3Rlckljb25NYXBwaW5nKGljb25JZCwgZ2x5cGhJZCkge1xuICAgICAgICBpZiAoZ2x5cGhNYXBwaW5nW2ljb25JZF0pIHtcbiAgICAgICAgICAgIHRoaXMubG9nLndhcm4oJ0ljb24gd2l0aCBpZCcsIGljb25JZCwgJ2FscmVhZHkgbWFwcGVkLiBJZ25vcmluZy4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG1hcCBpY29uLS0+Z2x5cGhcbiAgICAgICAgICAgIGdseXBoTWFwcGluZ1tpY29uSWRdID0gZ2x5cGhJZDtcbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBkZWZpbml0aW9uIGlzIGluc3RhbGxlZFxuICAgICAgICAgICAgdGhpcy5ncy5sb2FkRGVmcyh0aGlzLmVuc3VyZUljb25MaWJEZWZzKCksIFtnbHlwaElkXSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iXX0=